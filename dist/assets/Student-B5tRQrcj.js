import{P as v,r as m,j as e,L as g,g as R,b as w,u as I,p as k,f as B}from"./index-C4EYCwQF.js";import{u as E,a as L}from"./studentApiSlice-GuZAa6lx.js";import{c as P,d as A}from"./raportApiSlice-C9xJUIGH.js";import{B as C}from"./ButtonIcon-BiBhuHw3.js";import D from"./Back-DHOhBcRb.js";const S=({userDisplayed:s,setScreen:t})=>{var n;const[i,o]=m.useState(""),{data:a,isSuccess:h}=P(),[p,{isSuccess:l,isLoading:x,isError:j,error:c}]=A(),f=async d=>{d.preventDefault();try{const u=await p({username:s.username,raportId:i}).unwrap();t(!1),alert(`${u.message}`)}catch{alert(`${i} gagal ditambahkan`)}};m.useEffect(()=>{l&&t(!1)},[l,t]);let N;if(h){const{raports:d}=a,u=new Set(s.raportIdsStudent.map(r=>r.raportId)),b=d.filter(r=>!u.has(r._id)&&r.valid);N=b.length?e.jsxs("select",{name:"inputType",required:!0,onChange:r=>{r.preventDefault(),o(r.target.value)},children:[e.jsx("option",{value:"",children:"--Pilih buku raport--"}),b.map(r=>e.jsx("option",{value:r._id,children:r.name},r._id))]}):e.jsx("select",{disabled:!0,children:e.jsx("option",{children:"Buku belum divalidasi"})})}return e.jsxs(e.Fragment,{children:[g&&x,e.jsxs("form",{onSubmit:d=>f(d),className:"wrapper",children:[e.jsxs("div",{className:"title",style:{textAlign:"center"},children:[e.jsx("h1",{style:{fontSize:"1em"},children:"new raport"}),e.jsx("p",{style:{opacity:j?1:0,color:"red",fontSize:"0.6rem",width:"200px"},children:(n=c==null?void 0:c.data)==null?void 0:n.message})]}),e.jsx("div",{className:"inputBox",children:N}),e.jsx("button",{className:"enter",children:"Add"})]})]})};S.propTypes={userDisplayed:v.object.isRequired,setScreen:v.func.isRequired};const y=({student:s})=>{const t=R(),[i,o]=m.useState(!1),a=w(),h=I(),[p,{isSuccess:l,isLoading:x}]=E(),j=n=>{n.target.className==="container-student-new"&&o(!1)},c=n=>{a(`/students/${s.username}/records/${n}`,{state:{from:h}})},f=async n=>{n.preventDefault(),confirm(`anda yakin ingin menghapus ${s.username}?`)&&await p({username:s.username})};return m.useEffect(()=>{l&&a("/mentor/students")},[l,a]),e.jsxs("div",{className:"container-student-profile",children:[x&&e.jsx(g,{}),e.jsxs("div",{className:"container-back",children:[e.jsx("span",{className:"dotted-line"}),e.jsx(D,{previousPath:"/mentor/students"})]}),e.jsxs("div",{className:"wrapper",children:[e.jsx("div",{className:"profile",children:e.jsx("img",{className:"img-profile",src:s.urlImgProfile||k})}),e.jsxs("div",{className:"description",children:[e.jsx("div",{className:"top",children:e.jsx("h1",{children:"Profile"})}),e.jsxs("div",{className:"bottom",children:[e.jsx("table",{children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("i",{className:"fa-solid fa-user-tie"})}),e.jsx("td",{children:s.role})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("i",{className:"fa-solid fa-id-badge"})}),e.jsx("td",{children:s.username})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("i",{className:"fa-solid fa-phone"})}),e.jsx("td",{children:s.phone})]})]})}),t.id===s.mentorId&&e.jsx("div",{className:"button-profile",children:e.jsx("button",{className:"button-delete-student",onClick:f,children:"delete"})})]})]})]}),i&&e.jsx("div",{className:"container-student-new",onClick:j,children:e.jsx(S,{userDisplayed:s,setScreen:o})}),(s.role==="student"&&t.username===s.username||t.isMentor&&s.username!==t.username)&&e.jsxs("div",{className:"books",children:[e.jsx("h3",{children:"Raports"}),e.jsx("ul",{children:s.raportIdsStudent.map(n=>e.jsx("li",{onClick:()=>c(n.raportId),children:e.jsx("h4",{children:n.raportName})},n._id))})]}),t.isMentor&&e.jsx("div",{onClick:()=>o(!0),children:e.jsx(C,{text:"NEW",children:e.jsx("i",{className:"fa-solid fa-plus"})})})]})};y.propTypes={student:v.object.isRequired};const _=()=>{const{username:s}=B(),{students:t}=L("studentList",{selectFromResult:({data:a})=>({students:a==null?void 0:a.entities})});if(!t)return e.jsx(g,{});const i=Object.values(t).filter(a=>a.username===s)[0];if(!i)return e.jsx("h3",{children:"Student Not found"});const o=e.jsx(y,{student:i});return e.jsx(e.Fragment,{children:o})};export{_ as default};
